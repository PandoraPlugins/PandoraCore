package dev.minecraftplugin.pandoracore.patch.patches.exploit;

import com.azortis.azortislib.inventory.item.ItemBuilder;
import dev.minecraftplugin.pandoracore.PandoraCore;
import dev.minecraftplugin.pandoracore.patch.Patch;
import net.minecraft.server.v1_8_R3.Packet;
import org.bukkit.Bukkit;
import org.bukkit.Material;
import org.bukkit.inventory.ItemStack;
import org.bukkit.inventory.Recipe;

import java.util.Iterator;

public class DenyItemPatch extends Patch<Packet<?>> {
    public DenyItemPatch() {
        super("DenyItemPatch", "Stops crafting book and quills.", false,
                false, null, true);
    }

    @Override
    public void enable(PandoraCore core) {
        Iterator<Recipe> iterator = Bukkit.getServer().recipeIterator();
        while (iterator.hasNext()) {
            Recipe r = iterator.next();
            if (r.getResult().isSimilar(new ItemStack(Material.BOOK_AND_QUILL))) iterator.remove();
            if (r.getResult().isSimilar(ItemBuilder.start(Material.GOLDEN_APPLE).data((short) 1).build()))
                iterator.remove();
        }
    }

    @Override
    public void disable(PandoraCore core) {
    }
}
